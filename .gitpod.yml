# Gitpod / Ona Configuration
# For 200 workshop attendees - Zero Install Setup
#
# IMPORTANT: 'init' runs during PREBUILD (cached)
#            'command' runs at STARTUP (every time)

github:
  prebuilds:
    main: true
    branches: true
    pullRequests: true
    pullRequestsFromForks: false
    addCheck: true
    addComment: false
    addBadge: true

# Use Gitpod's full workspace image (Node 20 + Python + Go + etc)
image: gitpod/workspace-full:latest

tasks:
  - name: Welcome
    # INIT: Runs during prebuild - results are cached!
    init: |
      echo "ðŸ”§ Installing dependencies (this is cached in prebuild)..."
      npm install
      echo "ðŸŽ­ Installing Playwright Chromium..."
      npx playwright install chromium
      echo "ðŸ“¦ Installing Claude Code CLI..."
      npm install -g @anthropic-ai/claude-code
      echo "âœ… Prebuild complete!"

    # COMMAND: Runs every time workspace starts - shows welcome screen
    command: |
      chmod +x welcome.sh
      clear
      ./welcome.sh
      exec bash

ports:
  - port: 3000
    onOpen: open-preview
    visibility: public
    name: Landing Page Preview

# Don't auto-install Claude extension - it hijacks the UI
# Workshop uses 'claude' CLI instead
vscode:
  extensions: []
